# name: Second Playwright Tests
# on:
#   workflow_run:
#   workflows: ["Playwright Tests"]
#       types: [completed]
#   push:
#     branches: [ main, master ]
#   pull_request:
#     branches: [ main, master ]
# jobs:
#   test:
#     timeout-minutes: 60
#     runs-on: ubuntu-latest
#     steps:
#     - uses: actions/checkout@v4
#     - uses: actions/setup-node@v4
#       with:
#         node-version: lts/*
#     - name: Install dependencies
#       run: npm ci
#     - name: Install Playwright Browsers
#       run: npx playwright install --with-deps
#     - name: Run Playwright tests
#       run: npx playwright test
#     - uses: actions/upload-artifact@v4
#       if: always()
#       with:
#         name: playwright-report
#         path: playwright-report/
#         retention-days: 30

name: Second Playwright Tests (after success)

on:
  workflow_run:
    workflows: ["Playwright Tests"]
    types: [completed]

jobs:
  after:
    if: ${{ github.event.workflow_run.conclusion == 'success' }}
    runs-on: ubuntu-latest
    steps:
      - name: Show triggering workflow info
        run: |
          echo "Triggered by workflow run id: ${{ github.event.workflow_run.id }}"
          echo "Conclusion: ${{ github.event.workflow_run.conclusion }}"

      - name: Download Playwright report artifact from triggering workflow
        uses: actions/download-artifact@v4
        with:
          run-id: ${{ github.event.workflow_run.id }}
          name: playwright-report
          path: downloaded-report/

      - name: List downloaded files
        run: ls -la downloaded-report || true
